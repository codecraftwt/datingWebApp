<!-- visitors.component.html -->
<mat-card appearance="raised" class="w-100 shadow p-3 mt-3">
    <mat-card-header>
        <h6 class="mb-4 text-gradient text-uppercase">
            Visitors to your profile | {{totalItems}}
        </h6>
    </mat-card-header>
    <mat-card-content class="text-center">
        <div class="row mb-5">
            <ng-container *ngIf="userProfiles.length > 0; else noProfiles">
                <div class="col-sm-12 mb-3 mb-lg-0">
                    <div class="row">
                        @for (profile of userProfiles; track profile) {
                        <div class="col-lg-4 col-12 col-md-6 mb-4" [routerLink]="['/profile',profile.visitorId]">
                            <app-profile-card [profile]="profile" />
                        </div>
                        }
                    </div>

                    <div class="d-flex justify-content-between align-items-center">
                        <div class="ms-4">
                            Items per Page:
                            <select class="custom-select" [(ngModel)]="itemsPerPage" (change)="onChangeItems()">
                                <option [value]="10">10</option>
                                <option [value]="15">15</option>
                                <option [value]="30">30</option>
                                <option [value]="50">50</option>
                                <option [value]="100">100</option>
                            </select>
                        </div>

                        <div class="pagination me-4">
                            <pagination-controls 
                                [id]="'server-pagination'"
                                [maxSize]="5"
                                [directionLinks]="true"
                                [autoHide]="true"
                                [responsive]="true"
                                (pageChange)="onPageChange($event)">
                            </pagination-controls>
                        </div>
                    </div>
                    <div class="text-muted mt-2">
                        Page {{page}} of {{totalPages}}
                    </div>
                </div>
            </ng-container>

            <ng-template #noProfiles>
                <ng-container *ngIf="!isSubscriptionError; else subscriptionOnly">
                    <div class="col-12 col-md-12 mx-auto mb-4">
                        <div class="mb-4">
                            <i-feather name="users" class="big-heart"></i-feather>
                        </div>
                        <p class="text-start">
                            When other members visit your profile you can find out here.
                            <a href="#" class="link-text">Complete your profile now.</a>
                            A complete profile will be of particular interest to other members.
                        </p>
                    </div>
                </ng-container>
            </ng-template>

            <ng-template #subscriptionOnly>
                <div class="col-12 col-md-12 mx-auto mb-4">
                    <p class="text-gradient">This feature is for Premium Users only.</p>
                    <a routerLink="/subscriptions" class="btn btn-gradient border-0 rounded-pill mt-3">
                        Upgrade the Plan
                    </a>
                </div>
            </ng-template>
        </div>
    </mat-card-content>
</mat-card>